The directory /home/jusun/dever120/NCVX-Neural-Structural-Optimization/results/14iqk4u6 was created.
Building structure: mbb_beam_96x32_0.5
> [0;32m/users/5/dever120/.conda/envs/general/lib/python3.11/site-packages/autograd/numpy/numpy_wrapper.py[0m(37)[0;36mconcatenate_args[0;34m()[0m
[0;32m     35 [0;31m[0;34m@[0m[0mprimitive[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m     36 [0;31m[0;32mdef[0m [0mconcatenate_args[0m[0;34m([0m[0maxis[0m[0;34m,[0m [0;34m*[0m[0margs[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m---> 37 [0;31m    [0;32mreturn[0m [0m_np[0m[0;34m.[0m[0mconcatenate[0m[0;34m([0m[0margs[0m[0;34m,[0m [0maxis[0m[0;34m)[0m[0;34m.[0m[0mview[0m[0;34m([0m[0mndarray[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m     38 [0;31m[0mconcatenate[0m [0;34m=[0m [0;32mlambda[0m [0marr_list[0m[0;34m,[0m [0maxis[0m[0;34m=[0m[0;36m0[0m [0;34m:[0m [0mconcatenate_args[0m[0;34m([0m[0maxis[0m[0;34m,[0m [0;34m*[0m[0marr_list[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m     39 [0;31m[0mvstack[0m [0;34m=[0m [0mrow_stack[0m [0;34m=[0m [0;32mlambda[0m [0mtup[0m[0;34m:[0m [0mconcatenate[0m[0;34m([0m[0;34m[[0m[0matleast_2d[0m[0;34m([0m[0m_m[0m[0;34m)[0m [0;32mfor[0m [0m_m[0m [0;32min[0m [0mtup[0m[0;34m][0m[0;34m,[0m [0maxis[0m[0;34m=[0m[0;36m0[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m
axis = 0
args = ()
()
> [0;32m/users/5/dever120/.conda/envs/general/lib/python3.11/site-packages/autograd/tracer.py[0m(48)[0;36mf_wrapped[0;34m()[0m
[0;32m     46 [0;31m            [0;32mreturn[0m [0mnew_box[0m[0;34m([0m[0mans[0m[0;34m,[0m [0mtrace[0m[0;34m,[0m [0mnode[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m     47 [0;31m        [0;32melse[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m---> 48 [0;31m            [0;32mreturn[0m [0mf_raw[0m[0;34m([0m[0;34m*[0m[0margs[0m[0;34m,[0m [0;34m**[0m[0mkwargs[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m     49 [0;31m    [0mf_wrapped[0m[0;34m.[0m[0mfun[0m [0;34m=[0m [0mf_raw[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m     50 [0;31m    [0mf_wrapped[0m[0;34m.[0m[0m_is_autograd_primitive[0m [0;34m=[0m [0;32mTrue[0m[0;34m[0m[0;34m[0m[0m
[0m
(0,)
{}
> [0;32m/users/5/dever120/.conda/envs/general/lib/python3.11/site-packages/autograd/numpy/numpy_wrapper.py[0m(38)[0;36m<lambda>[0;34m()[0m
[0;32m     36 [0;31m[0;32mdef[0m [0mconcatenate_args[0m[0;34m([0m[0maxis[0m[0;34m,[0m [0;34m*[0m[0margs[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m     37 [0;31m    [0;32mreturn[0m [0m_np[0m[0;34m.[0m[0mconcatenate[0m[0;34m([0m[0margs[0m[0;34m,[0m [0maxis[0m[0;34m)[0m[0;34m.[0m[0mview[0m[0;34m([0m[0mndarray[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m---> 38 [0;31m[0mconcatenate[0m [0;34m=[0m [0;32mlambda[0m [0marr_list[0m[0;34m,[0m [0maxis[0m[0;34m=[0m[0;36m0[0m [0;34m:[0m [0mconcatenate_args[0m[0;34m([0m[0maxis[0m[0;34m,[0m [0;34m*[0m[0marr_list[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m     39 [0;31m[0mvstack[0m [0;34m=[0m [0mrow_stack[0m [0;34m=[0m [0;32mlambda[0m [0mtup[0m[0;34m:[0m [0mconcatenate[0m[0;34m([0m[0;34m[[0m[0matleast_2d[0m[0;34m([0m[0m_m[0m[0;34m)[0m [0;32mfor[0m [0m_m[0m [0;32min[0m [0mtup[0m[0;34m][0m[0;34m,[0m [0maxis[0m[0;34m=[0m[0;36m0[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m     40 [0;31m[0;32mdef[0m [0mhstack[0m[0;34m([0m[0mtup[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m
[]
> [0;32m/users/5/dever120/.conda/envs/general/lib/python3.11/site-packages/neural_structural_optimization/train.py[0m(89)[0;36m_get_variables[0;34m()[0m
[0;32m     87 [0;31m[0;34m[0m[0m
[0m[0;32m     88 [0;31m[0;32mdef[0m [0m_get_variables[0m[0;34m([0m[0mvariables[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m---> 89 [0;31m  return np.concatenate([
[0m[0;32m     90 [0;31m      [0mv[0m[0;34m.[0m[0mnumpy[0m[0;34m([0m[0;34m)[0m[0;34m.[0m[0mravel[0m[0;34m([0m[0;34m)[0m [0;32mif[0m [0;32mnot[0m [0misinstance[0m[0;34m([0m[0mv[0m[0;34m,[0m [0mnp[0m[0;34m.[0m[0mndarray[0m[0;34m)[0m [0;32melse[0m [0mv[0m[0;34m.[0m[0mravel[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m     91 [0;31m      for v in variables])
[0m
*** NameError: name 'v' is not defined
> [0;32m/users/5/dever120/.conda/envs/general/lib/python3.11/site-packages/neural_structural_optimization/train.py[0m(150)[0;36mmethod_of_moving_asymptotes[0;34m()[0m
[0;32m    148 [0;31m  [0menv[0m [0;34m=[0m [0mmodel[0m[0;34m.[0m[0menv[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m    149 [0;31m  [0;32mif[0m [0minit_model[0m [0;32mis[0m [0;32mNone[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m--> 150 [0;31m    [0mx0[0m [0;34m=[0m [0m_get_variables[0m[0;34m([0m[0mmodel[0m[0;34m.[0m[0mtrainable_variables[0m[0;34m)[0m[0;34m.[0m[0mastype[0m[0;34m([0m[0mnp[0m[0;34m.[0m[0mfloat64[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m    151 [0;31m  [0;32melse[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m    152 [0;31m    [0mx0[0m [0;34m=[0m [0mconstrained_logits[0m[0;34m([0m[0minit_model[0m[0;34m)[0m[0;34m.[0m[0mravel[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m
[]
[1;32m    140 [0mdef method_of_moving_asymptotes(
[1;32m    141 [0m    [0mmodel[0m[0;34m,[0m [0mmax_iterations[0m[0;34m,[0m [0msave_intermediate_designs[0m[0;34m=[0m[0;32mTrue[0m[0;34m,[0m [0minit_model[0m[0;34m=[0m[0;32mNone[0m[0;34m,[0m[0;34m[0m[0;34m[0m[0m
[1;32m    142 [0m):
[1;32m    143 [0m  [0;32mimport[0m [0mnlopt[0m  [0;31m# pylint: disable=g-import-not-at-top[0m[0;34m[0m[0;34m[0m[0m
[1;32m    144 [0m[0;34m[0m[0m
[1;32m    145 [0m  [0;32mif[0m [0;32mnot[0m [0misinstance[0m[0;34m([0m[0mmodel[0m[0;34m,[0m [0mmodels[0m[0;34m.[0m[0mPixelModel[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    146 [0m    [0;32mraise[0m [0mValueError[0m[0;34m([0m[0;34m'MMA only defined for pixel models'[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    147 [0m[0;34m[0m[0m
[1;32m    148 [0m  [0menv[0m [0;34m=[0m [0mmodel[0m[0;34m.[0m[0menv[0m[0;34m[0m[0;34m[0m[0m
[1;32m    149 [0m  [0;32mif[0m [0minit_model[0m [0;32mis[0m [0;32mNone[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 150 [0;31m    [0mx0[0m [0;34m=[0m [0m_get_variables[0m[0;34m([0m[0mmodel[0m[0;34m.[0m[0mtrainable_variables[0m[0;34m)[0m[0;34m.[0m[0mastype[0m[0;34m([0m[0mnp[0m[0;34m.[0m[0mfloat64[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    151 [0m  [0;32melse[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    152 [0m    [0mx0[0m [0;34m=[0m [0mconstrained_logits[0m[0;34m([0m[0minit_model[0m[0;34m)[0m[0;34m.[0m[0mravel[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    153 [0m[0;34m[0m[0m
[1;32m    154 [0m  [0;32mdef[0m [0mobjective[0m[0;34m([0m[0mx[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    155 [0m    [0;32mreturn[0m [0menv[0m[0;34m.[0m[0mobjective[0m[0;34m([0m[0mx[0m[0;34m,[0m [0mvolume_contraint[0m[0;34m=[0m[0;32mFalse[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    156 [0m[0;34m[0m[0m
[1;32m    157 [0m  [0;32mdef[0m [0mconstraint[0m[0;34m([0m[0mx[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    158 [0m    [0;32mreturn[0m [0menv[0m[0;34m.[0m[0mconstraint[0m[0;34m([0m[0mx[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    159 [0m[0;34m[0m[0m
[1;32m    160 [0m  [0;32mdef[0m [0mwrap_autograd_func[0m[0;34m([0m[0mfunc[0m[0;34m,[0m [0mlosses[0m[0;34m=[0m[0;32mNone[0m[0;34m,[0m [0mframes[0m[0;34m=[0m[0;32mNone[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    161 [0m    [0;32mdef[0m [0mwrapper[0m[0;34m([0m[0mx[0m[0;34m,[0m [0mgrad[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    162 [0m      [0;32mif[0m [0mgrad[0m[0;34m.[0m[0msize[0m [0;34m>[0m [0;36m0[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    163 [0m        [0mvalue[0m[0;34m,[0m [0mgrad[0m[0;34m[[0m[0;34m:[0m[0;34m][0m [0;34m=[0m [0mautograd[0m[0;34m.[0m[0mvalue_and_grad[0m[0;34m([0m[0mfunc[0m[0;34m)[0m[0;34m([0m[0mx[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    164 [0m      [0;32melse[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    165 [0m        [0mvalue[0m [0;34m=[0m [0mfunc[0m[0;34m([0m[0mx[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    166 [0m      [0;32mif[0m [0mlosses[0m [0;32mis[0m [0;32mnot[0m [0;32mNone[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    167 [0m        [0mlosses[0m[0;34m.[0m[0mappend[0m[0;34m([0m[0mvalue[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    168 [0m      [0;32mif[0m [0mframes[0m [0;32mis[0m [0;32mnot[0m [0;32mNone[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    169 [0m        [0mframes[0m[0;34m.[0m[0mappend[0m[0;34m([0m[0menv[0m[0;34m.[0m[0mreshape[0m[0;34m([0m[0mx[0m[0;34m)[0m[0;34m.[0m[0mcopy[0m[0;34m([0m[0;34m)[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    170 [0m      [0;32mreturn[0m [0mvalue[0m[0;34m[0m[0;34m[0m[0m
[1;32m    171 [0m    [0;32mreturn[0m [0mwrapper[0m[0;34m[0m[0;34m[0m[0m
[1;32m    172 [0m[0;34m[0m[0m
[1;32m    173 [0m  [0mlosses[0m [0;34m=[0m [0;34m[[0m[0;34m][0m[0;34m[0m[0;34m[0m[0m
[1;32m    174 [0m  [0mframes[0m [0;34m=[0m [0;34m[[0m[0;34m][0m[0;34m[0m[0;34m[0m[0m
[1;32m    175 [0m[0;34m[0m[0m
[1;32m    176 [0m  [0mopt[0m [0;34m=[0m [0mnlopt[0m[0;34m.[0m[0mopt[0m[0;34m([0m[0mnlopt[0m[0;34m.[0m[0mLD_MMA[0m[0;34m,[0m [0mx0[0m[0;34m.[0m[0msize[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    177 [0m  [0mopt[0m[0;34m.[0m[0mset_lower_bounds[0m[0;34m([0m[0;36m0.0[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    178 [0m  [0mopt[0m[0;34m.[0m[0mset_upper_bounds[0m[0;34m([0m[0;36m1.0[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    179 [0m  [0mopt[0m[0;34m.[0m[0mset_min_objective[0m[0;34m([0m[0mwrap_autograd_func[0m[0;34m([0m[0mobjective[0m[0;34m,[0m [0mlosses[0m[0;34m,[0m [0mframes[0m[0;34m)[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    180 [0m  [0mopt[0m[0;34m.[0m[0madd_inequality_constraint[0m[0;34m([0m[0mwrap_autograd_func[0m[0;34m([0m[0mconstraint[0m[0;34m)[0m[0;34m,[0m [0;36m1e-8[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    181 [0m  [0mopt[0m[0;34m.[0m[0mset_maxeval[0m[0;34m([0m[0mmax_iterations[0m [0;34m+[0m [0;36m1[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    182 [0m  [0mopt[0m[0;34m.[0m[0moptimize[0m[0;34m([0m[0mx0[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    183 [0m[0;34m[0m[0m
[1;32m    184 [0m  [0mdesigns[0m [0;34m=[0m [0;34m[[0m[0menv[0m[0;34m.[0m[0mrender[0m[0;34m([0m[0mx[0m[0;34m,[0m [0mvolume_contraint[0m[0;34m=[0m[0;32mFalse[0m[0;34m)[0m [0;32mfor[0m [0mx[0m [0;32min[0m [0mframes[0m[0;34m][0m[0;34m[0m[0;34m[0m[0m
[1;32m    185 [0m  return optimizer_result_dataset(np.array(losses), np.array(designs),
[1;32m    186 [0m                                  save_intermediate_designs)
[1;32m    187 [0m[0;34m[0m[0m

<PixelModel name=pixel_model, built=False>
